% dvips -t letter lab_svd.dvi -o lab_svd.ps ; ps2pdf lab_svd.ps
\documentclass[11pt,titlepage,fleqn]{article}

\input{hw627_header}

%\renewcommand{\baselinestretch}{1.0}

\newcommand{\tfile}{{\tt lab\_svdspectrum.ipynb}}
\newcommand{\nfile}{{\tt notes\_svd.pdf}}

% change the figures to ``Figure L3'', etc
\renewcommand{\thefigure}{L\arabic{figure}}
\renewcommand{\thetable}{L\arabic{table}}
\renewcommand{\theequation}{L\arabic{equation}}
\renewcommand{\thesection}{L\arabic{section}}

%--------------------------------------------------------------
\begin{document}
%-------------------------------------------------------------

\begin{spacing}{1.2}
\centering
{\large \bf Lab Exercise: Singular value spectra [svdspectrum]} \\
\cltag\ \\
Last compiled: \today
\end{spacing}

%------------------------

\subsection*{Background}

This is the third of a series of labs on the SVD: \verb+lab_svdgeometry+, \verb+lab_svdballistic+, \verb+lab_svdspectrum+. The notes that augment \citet{Aster} are \nfile.

The singular value decomposition of $\ndata \times \nparm$ matrix $\bG$ is given by
%
\begin{eqnarray*}
\bG &=& \bU\bS\bV^T.
\end{eqnarray*}
%
This is useful for examining linear inverse problems of the form $\bG\bem = \bd$.

The {\em singular value spectrum} is simply the set of singular values
%
\begin{equation*}
s_k = S_{kk} \ge 0
\end{equation*}
%
where $k$ ranges from 1 to $\min(\ndata,\nparm)$.

%------------------------

\subsection*{Instructions}

\begin{enumerate}

\item \citet[][Section~3.5, p.~74]{Aster} provides criteria for classifying the ``posed-ness'' of a linear inverse problem based on the singular values $s_k$:
%
\begin{enumerate}
\renewcommand{\theenumi}{\Alph{enumi}}
\item mildly ill-posed: $s_k = h k^{-\alpha}$, $\alpha \le 1$
\item moderately ill-posed: $s_k = h k^{-\alpha}$, $\alpha > 1$
\item severely ill-posed: $s_k = h e^{-\alpha k}$
\end{enumerate}
%
Here $h$ and $\alpha$ are unknown.

Transform each equation so that it can be written as the equation of a line. This should inform how to plot the singular values.

\item The function \verb+ex_getG()+ will return the forward linear model $\bG$ for the four models in \citet{Aster}. Run \tfile\ and analyze the matrixplots of $\bG$ for each of the 8 examples listed at the top of \verb+ex_getG()+ (which resides in \verb+lib_peip.py+). Make sure you understand why they look the way they do.

\item Write code to call \verb+ex_getG()+ and plot the singular value spectrum for each of the 8 examples. (If you prefer, you can set \verb+bfigure = false+ in \verb+ex_getG()+ to avoid seeing the matrix plots.)

\pagebreak
\item Based the singular value spectra, identify the posed-ness category (a), (b), or (c) for each example below:
%
\begin{spacing}{1.5}
\begin{verbatim}
G = ex_getG(3,210,210)   % Example 3.2
G = ex_getG(1)           % Example 1.12
G = ex_getG(2,100,100)   % Exercise 1-3-a
G = ex_getG(2,4,4)       % Exercise 1-3-e
G = ex_getG(2,4,20)      % Example 4.4
G = ex_getG(2,20,4)
G = ex_getG(4,20,20)     % Example 1.6, 3.3
G = ex_getG(4,100,100)   % Example 1.6, 3.3
\end{verbatim}
\end{spacing}
%
For line-fitting, see our options from \verb+lab_linefit.ipynb+.

\end{enumerate}

%-------------------------------------------------------------
\bibliography{uaf_abbrev,uaf_main}
%-------------------------------------------------------------
\end{document}
%-------------------------------------------------------------
